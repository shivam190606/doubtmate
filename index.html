{% extends 'layout.html' %}
{% block content %}

  <h1 class="page-title">Recent Doubts</h1>

  {% if doubts|length == 0 %}
    <p>No doubts posted yet. Be the first to <a href="{{ url_for('post_doubt') }}">post a doubt</a>.</p>
  {% endif %}

  <div class="doubt-list">
    {% for d in doubts %}
      <div class="doubt">
        <h2 class="doubt-title">
          <a href="{{ url_for('view_doubt', doubt_id=d.id) }}">{{ d.title }}</a>
        </h2>

        <div class="doubt-meta">
          by <a href="{{ url_for('profile', username=d.username) }}">{{ d.username or 'Anonymous' }}</a>
          â€¢ {{ d.created_at.split('T')[0] }}
        </div>

        <p class="doubt-desc">
          {{ d.description[:250] }}{% if d.description|length > 250 %}...{% endif %}
        </p>

        <a class="link" href="{{ url_for('view_doubt', doubt_id=d.id) }}">View & Reply</a>

        {% if user and user.id == d.user_id %}
          <div style="margin-top:10px;">
            <a class="btn ghost" href="{{ url_for('edit_doubt', doubt_id=d.id) }}">Edit</a>

            <form method="post"
                  action="{{ url_for('delete_doubt', doubt_id=d.id) }}"
                  style="display:inline;">
              <button class="btn ghost"
                      type="submit"
                      onclick="return confirm('Are you sure you want to delete this doubt?');">
                Delete
              </button>
            </form>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>

{% endblock %}
